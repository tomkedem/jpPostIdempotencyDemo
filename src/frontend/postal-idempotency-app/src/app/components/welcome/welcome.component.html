<div
  class="w-full max-w-7xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden border border-gray-200/80"
>
  <div class="p-8 sm:p-12">
    <!-- Header Section -->
    <header class="text-center mb-12">
      <h1
        class="text-4xl sm:text-5xl font-extrabold text-gray-900 tracking-tight flex items-center justify-center gap-3"
      >
        <span class="material-icons text-blue-600 text-5xl">verified_user</span>
        <span>הבטחת אמינות בעידן הדיגיטלי: יישום אידמפוטנטיות</span>
      </h1>
      <p class="mt-4 max-w-3xl mx-auto text-lg text-gray-600">
        הדגמה חיה של טיפול בבקשות רשת באופן עמיד, בטוח וצפוי, גם בתנאים של חוסר
        ודאות.
      </p>
    </header>

    <!-- Main Content Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-5 gap-12 items-start">
      <!-- Left Column: Textual Content -->
      <div class="lg:col-span-3 rtl:pl-8">
        <section>
          <h2
            class="text-3xl font-bold text-gray-800 border-r-4 border-blue-500 pr-4 mb-6"
          >
            מהי אידמפוטנטיות (Idempotency)?
          </h2>
          <p class="text-lg text-gray-700 leading-relaxed">
            במחשוב, פעולה אידמפוטנטית היא פעולה שאם תתבצע פעם אחת או מספר פעמים,
            התוצאה הסופית של המערכת תהיה זהה. תכונה זו חיונית במערכות מבוזרות,
            בהן תקלות רשת עלולות לגרום לשליחה כפולה של בקשות. שרת המיישם
            אידמפוטנטיות מבטיח שפעולה קריטית (כמו חיוב לקוח או יצירת משלוח)
            תתבצע פעם אחת בלבד, לא משנה כמה פעמים הבקשה הגיעה.
          </p>
        </section>

        <section class="mt-12">
          <h2
            class="text-3xl font-bold text-gray-800 border-r-4 border-blue-500 pr-4 mb-6"
          >
            איך זה עובד? אלגוריתם הטיפול בבקשה
          </h2>
          <p class="text-lg text-gray-700 leading-relaxed mb-6">
            כדי להבטיח טיפול אידמפוטנטי, כל בקשה ליצירת משלוח חייבת לכלול מפתח
            ייחודי הנקרא <code>Idempotency-Key</code>. השרת משתמש במפתח זה כדי
            לזהות בקשות כפולות ולמנוע ביצוע חוזר של אותה פעולה. התהליך מתבצע לפי
            השלבים הבאים:
          </p>
          <ul class="space-y-4 text-lg">
            <li class="flex items-start">
              <span class="material-icons text-green-500 mt-1 ml-3"
                >vpn_key</span
              >
              <span
                ><strong>בדיקת המפתח:</strong> השרת בודק אם כבר קיבל בקשה עם
                מפתח זה.</span
              >
            </li>
            <li class="flex items-start">
              <span class="material-icons text-blue-500 mt-1 ml-3"
                >sync_lock</span
              >
              <span
                ><strong>נעילת המפתח:</strong> אם המפתח חדש, השרת נועל אותו כדי
                למנוע טיפול מקבילי באותה בקשה על ידי תהליכים אחרים.</span
              >
            </li>
            <li class="flex items-start">
              <span class="material-icons text-purple-500 mt-1 ml-3"
                >hourglass_top</span
              >
              <span
                ><strong>עיבוד הבקשה:</strong> השרת מבצע את הלוגיקה העסקית
                (יצירת המשלוח) ושומר את תוצאת הפעולה (הצלחה או כישלון) יחד עם
                המפתח.</span
              >
            </li>
            <li class="flex items-start">
              <span class="material-icons text-red-500 mt-1 ml-3">replay</span>
              <span
                ><strong>טיפול בבקשות כפולות:</strong> אם המפתח כבר קיים, השרת
                לא יבצע את הפעולה שוב, אלא יחזיר מיד את התוצאה השמורה.</span
              >
            </li>
          </ul>
        </section>
      </div>

      <!-- Right Column: Flowchart -->
      <div
        class="lg:col-span-2 flex flex-col items-center justify-center bg-gray-50 p-6 rounded-lg border"
      >
        <figure>
          <img
            src="assets/images/idempotency-flow.png"
            alt="תרשים זרימה של אלגוריתם אידמפוטנטיות"
            class="w-full h-auto object-contain rounded-md shadow-md border"
          />
          <figcaption class="mt-4 text-center text-sm text-gray-600">
            תרשים זרימה המתאר את תהליך הטיפול בבקשה בשרת
          </figcaption>
        </figure>
      </div>
    </div>
  </div>
</div>
