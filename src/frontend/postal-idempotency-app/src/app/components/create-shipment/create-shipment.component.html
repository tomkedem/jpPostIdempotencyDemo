<div class="create-shipment-container">
  <mat-card>
    <mat-card-header>
      <div class="ai-dots"></div>
      <mat-card-title> 住专转 砖</mat-card-title>
      <mat-card-subtitle> 转 驻专 专砖 住专转 砖 注专转</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="shipmentForm" (ngSubmit)="onSubmit()">
        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label> 专拽</mat-label>
            <input matInput formControlName="barcode" placeholder="住 专拽">
            <mat-icon matSuffix>qr_code</mat-icon>
            <mat-error *ngIf="shipmentForm.get('barcode')?.hasError('required')">
              专拽  砖 
            </mat-error>
            <mat-error *ngIf="shipmentForm.get('barcode')?.hasError('minlength')">
              专拽   驻转 3 转
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>  注</mat-label>
            <input matInput formControlName="employeeId" placeholder="住  注">
            <mat-icon matSuffix>badge</mat-icon>
            <mat-error *ngIf="shipmentForm.get('employeeId')?.hasError('required')">
               注  砖 
            </mat-error>
            <mat-error *ngIf="shipmentForm.get('employeeId')?.hasError('minlength')">
               注   驻转 2 转
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label> 拽 专</mat-label>
            <input matInput formControlName="locationLat" placeholder="32.0853" type="number" step="any">
            <mat-icon matSuffix>my_location</mat-icon>
            <mat-error *ngIf="shipmentForm.get('locationLat')?.hasError('pattern')">
              拽 专  转 住驻专 转拽
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label> 拽 专</mat-label>
            <input matInput formControlName="locationLng" placeholder="34.7818" type="number" step="any">
            <mat-icon matSuffix>place</mat-icon>
            <mat-error *ngIf="shipmentForm.get('locationLng')?.hasError('pattern')">
              拽 专  转 住驻专 转拽
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline" class="form-field">
            <mat-label> 砖 注</mat-label>
            <input matInput formControlName="recipientName" placeholder="住 砖 注">
            <mat-icon matSuffix>person</mat-icon>
            <mat-error *ngIf="shipmentForm.get('recipientName')?.hasError('minlength')">
              砖 注   驻转 2 转
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label> 住住 住专</mat-label>
            <mat-select formControlName="statusId">
              @for (status of statuses; track status.id) {
                <mat-option [value]="status.id">{{ status.name }}</mat-option>
              }
            </mat-select>
            <mat-icon matSuffix>assignment_turned_in</mat-icon>
            @if (shipmentForm.get('statusId')?.hasError('required')) {
              <mat-error>砖 </mat-error>
            }
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline" class="form-field notes-field">
            <mat-label> 注专转</mat-label>
            <textarea matInput formControlName="notes" placeholder="住 注专转 住驻转" rows="3"></textarea>
            <mat-icon matSuffix>note</mat-icon>
          </mat-form-field>
        </div>

        <div class="button-row">
          <button 
            mat-raised-button 
            color="primary" 
            type="submit" 
            [disabled]="!shipmentForm.valid || isLoading()">
            <div class="particles"></div>
            <mat-icon>local_shipping</mat-icon>
            @if (isLoading()) {
              专砖 住专...
            } @else {
              专砖 住专
            }
          </button>

          <button 
            mat-raised-button 
            color="accent" 
            type="button" 
            (click)="testConnection()"
            [disabled]="isLoading()">
            <div class="particles"></div>
            <mat-icon>wifi</mat-icon>
            @if (isLoading()) {
              拽...
            } @else {
              拽 专 API
            }
          </button>

          <button 
            mat-button 
            type="button" 
            (click)="onReset()"
            [disabled]="isLoading()">
            <div class="particles"></div>
            <mat-icon>refresh</mat-icon>
            驻住
          </button>
        </div>
      </form>

      @if (isLoading()) {
        <div class="loading-overlay">
          <div class="loading-spinner"></div>
          <div class="loading-text">专砖 住专...</div>
        </div>
      }
    </mat-card-content>
  </mat-card>

  @if (lastResponse()) {
    <mat-card class="response-card">
      <mat-card-header>
        <mat-card-title>转转 砖专转</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <pre>{{ lastResponse() | json }}</pre>
      </mat-card-content>
    </mat-card>
  }
</div>
